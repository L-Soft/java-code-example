/**
* Alopex UI v2.10.1
* http://ui.alopex.io
*
* Copyright (c) 2018 SK Holdings C&C. All rights reserved.
*
* This software is the confidential and proprietary information of SK Holdings C&C.
* You shall not disclose such confidential information and shall use it only in
* accordance with the terms of the license agreement you entered into with SK Holdings C&C.
*
* Date :  2018-02-01 13:08:57 GMT+0900 (대한민국 표준시)
**/
$a.widget.reporting=$a.inherit($a.widget.object,{widgetName:"reporting",properties:{pdfFonts:null,alopexGrid:{exportDragDropColumn:!0,exportSelectorColumn:!0,exportNumberingColumn:!0},defaultOptions:{pageSize:"A4",pageOrientation:"portrait",pageMargins:[40,60,40,60],pageBreak:"before",useRenderStyle:!0,defaultStyle:{font:"malgun",fontSize:8}},pointRatio:72/92,pageSizeInfo:{"4A0":[4767.87,6740.79],"2A0":[3370.39,4767.87],A0:[2383.94,3370.39],A1:[1683.78,2383.94],A2:[1190.55,1683.78],A3:[841.89,1190.55],A4:[595.28,841.89],A5:[419.53,595.28],A6:[297.64,419.53],A7:[209.76,297.64],A8:[147.4,209.76],A9:[104.88,147.4],A10:[73.7,104.88],B0:[2834.65,4008.19],B1:[2004.09,2834.65],B2:[1417.32,2004.09],B3:[1000.63,1417.32],B4:[708.66,1000.63],B5:[498.9,708.66],B6:[354.33,498.9],B7:[249.45,354.33],B8:[175.75,249.45],B9:[124.72,175.75],B10:[87.87,124.72],C0:[2599.37,3676.54],C1:[1836.85,2599.37],C2:[1298.27,1836.85],C3:[918.43,1298.27],C4:[649.13,918.43],C5:[459.21,649.13],C6:[323.15,459.21],C7:[229.61,323.15],C8:[161.57,229.61],C9:[113.39,161.57],C10:[79.37,113.39],RA0:[2437.8,3458.27],RA1:[1729.13,2437.8],RA2:[1218.9,1729.13],RA3:[864.57,1218.9],RA4:[609.45,864.57],SRA0:[2551.18,3628.35],SRA1:[1814.17,2551.18],SRA2:[1275.59,1814.17],SRA3:[907.09,1275.59],SRA4:[637.8,907.09],EXECUTIVE:[521.86,756],FOLIO:[612,936],LEGAL:[612,1008],LETTER:[612,792],TABLOID:[792,1224]},styleInfoAttrName:"data-style",checked:{radio:{checkedText:"(*)",uncheckedText:"( )"},checkbox:{checkedText:"[v]",uncheckedText:"[ ]"}}}}),function(a){"use strict";function b(b,d,e){var g=A=a.alopex.widget.reporting.properties,h=this;z=a.extend(!0,{},g.defaultOptions,b),e&&"pdf"!==e||(g.pdfFonts&&(pdfMake.fonts=g.pdfFonts),z.footer===!0&&(z.footer=c),a.when(B(z.watermarkImage,z.pageSize,b.pageOrientation),D()).done(function(a,b){switch(z.watermarkImage&&"none"!=a&&(z.background=[{image:a}]),z.content=f(h,z),d){case"open":default:z.window?pdfMake.createPdf(z).open({},z.window):pdfMake.createPdf(z).open();break;case"download":"function"==typeof z.downloadCallback?pdfMake.createPdf(z).download(z.filename,z.downloadCallback):pdfMake.createPdf(z).download(z.filename);break;case"print":z.window?pdfMake.createPdf(z).print({},z.window):pdfMake.createPdf(z).print()}return pdfMake.createPdf(z)}).fail(function(a){}))}function c(a,b){return{text:a.toString()+" / "+b,alignment:"center"}}function d(a){var b=A.pointRatio;return"number"!=typeof a&&(a=parseInt(a)),a*b}function e(a,b,c,d){var e=new Image,f=A.pageSizeInfo;e.crossOrigin="Anonymous",e.onload=function(){var e,g=document.createElement("canvas"),h=g.getContext("2d"),i=c.toUpperCase();switch(d){case"portrait":g.width=f[i][0],g.height=f[i][1];break;case"landscape":g.width=f[i][1],g.height=f[i][0];break;default:g.width=f[i][0],g.height=f[i][1]}a.opacity&&(h.globalAlpha=a.opacity);var j=g.width/2-this.naturalWidth/2,k=g.height/2-this.naturalHeight/2;if("center"==a.type)a.rotate?(h.translate(j,k),h.translate(this.naturalWidth/2,this.naturalHeight/2),h.rotate(-a.rotate*Math.PI/180),h.drawImage(this,-(this.naturalWidth/2),-(this.naturalHeight/2))):h.drawImage(this,j,k);else{var l=10;a.tilesgap&&(l=a.tilesgap);var m=Math.ceil(g.width/this.naturalWidth),n=Math.ceil(g.height/this.naturalHeight);if(a.rotate)for(var o=0;n>o;o++)for(var p=0;m>p;p++){var q=p*(this.naturalWidth+l),r=o*(this.naturalHeight+l);h.save(),h.translate(q,r),h.translate(this.naturalWidth/2,this.naturalHeight/2),h.rotate(-a.rotate*Math.PI/180),h.drawImage(this,-(this.naturalWidth/2),-(this.naturalHeight/2)),h.restore()}else for(var o=0;n>o;o++)for(var p=0;m>p;p++){var q=p*(this.naturalWidth+l),r=o*(this.naturalHeight+l);h.drawImage(this,q,r)}}if(a.grayscale){var s=h.getImageData(0,0,g.width,g.height);for(o=0;o<s.height;o++)for(p=0;p<s.width;p++){var t=4*o*s.width+4*p,u=s.data[t],v=s.data[t+1],w=s.data[t+2],x=s.data[t+3],y=(u+v+w)/3;s.data[t]=y,s.data[t+1]=y,s.data[t+2]=y,s.data[t+3]=x}h.putImageData(s,0,0,0,0,s.width,s.height)}e=g.toDataURL("image/png"),b(e)},e.onerror=function(a){b("error : Watermark Image URL is invalid.")},e.src=a.image}function f(b,c){var d,e=[],f=A.styleInfoAttrName,h=["fontSize","color","backgroundColor","fontWeight","fontStyle","textAlign","marginLeft","marginTop","marginRight","marginBottom","verticalAlign","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth"];if(c.useRenderStyle){var j,d;Date.now();a(b).find("*").each(function(a,b){d={},j=window.getComputedStyle(b);for(var c in j)h.indexOf(c)>-1&&("backgroundColor"!==c||"rgba(0, 0, 0, 0)"!==j[c]&&"transparent"!==j[c])&&(d[c]=j[c]);b.setAttribute(f,JSON.stringify(d))})}var k;a("input, textarea, select").each(function(){this.hasAttribute("id")||(k="Alopex_report_"+parseInt(1e4*Math.random()),this.setAttribute("id",k))});for(var l=a(a(b).html().replace(/\n/g,"").replace(/[\t ]+\</g,"<").replace(/\>[\t ]+\</g,"><").replace(/\>[\t ]+$/g,">")),m=i(),n=0;n<l.length;n++)g(e,l.get(n),m);return e}function g(b,c,e,f){var g=c.nodeType,n=c.nodeName.toLowerCase(),o=A.styleInfoAttrName;if(z.useRenderStyle&&g===Node.ELEMENT_NODE){if(c.getAttribute(o)&&(f=JSON.parse(c.getAttribute(o)),"none"===f.display))return}else f={};switch(n){case"#text":b.push(c.textContent.replace(/\n/g,""));break;case"b":case"strong":z.useRenderStyle||(f.fontWeight="bold"),h(b,c,e,f);break;case"u":z.useRenderStyle||(f.textDecoration="underline"),h(b,c,e,f);break;case"i":z.useRenderStyle||(f.fontStyle="italick"),h(b,c,e,f);break;case"span":e=i(),h(b,c,e,f);break;case"br":e=i(),b.push(e);break;case"table":var p={table:{widths:[],body:[]}},q=c.getAttribute("border"),s=!0;q&&1==parseInt(q)&&(s=!0),s||(p.layout="noBorders"),h(p.table.body,c,e,f);var t=c.getElementsByTagName("colgroup")[0];if(t){var u=t.childNodes;p.table.widths=new Array(u.length);for(var v=0;v<u.length;v++){var w=u[v].style;if(w&&w.width){var x=w.width;-1!==x.indexOf("%")?p.table.widths[v]=x:p.table.widths[v]=d(u[v].style.width)}else p.table.widths[v]="*"}}for(var y=0;y<p.table.body.length;y++)for(var B=p.table.body[y],D=0;D<B.length;D++)if("undefined"==typeof B[D]&&(B[D]={}),B[D].rowSpan){var E,F=B[D].rowSpan;E=B[D].colSpan?B[D].colSpan:1;for(var G=1;F>G;G++){"undefined"==typeof p.table.body[y+G]&&p.table.body.push(new Array(p.table.body[y].length));for(var H=0;E>H;H++)p.table.body[y+G].splice(D,0,{})}}m(p.table.body,f),b.push(p);break;case"tbody":case"thead":h(b,c,e,f);break;case"tr":var B=[];h(B,c,e,f),l(B,f),b.push(B);break;case"th":case"td":e=i();var I=j();h(I.stack,c,e);var J=!0;for(var y in I.stack)if(!I.stack[y].hasOwnProperty("text")&&"string"!=typeof I.stack[y]){J=!1;break}J&&(I={text:I.stack},delete I.stack),b.push(I),f&&k(I,f);var K=c.getAttribute("rowspan");K&&(I.rowSpan=parseInt(K));var L=c.getAttribute("colspan");if(L){I.colSpan=parseInt(L);for(var y=1;y<I.colSpan;y++)b.push({})}f&&k(I,f);break;case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":e=i();var I=j();I.stack.push(e),k(I,f),h(I.stack,c,e),b.push(I);break;case"div":case"p":e=i();var I=j(),M=c.className.split(" ");if(a(c).find("> div.amcharts-main-div").length){var c=document.getElementById(c.id),N=window.getComputedStyle(c),O={image:C[c.id].exportedImage,fit:[d(N.width),d(N.height)],alignment:"center"};I.stack.push(O),b.push(I)}else if(M.indexOf("alopexgrid")>=0)r(b,c,e,f);else if(M.indexOf("Divselect")>=0)b.push(c.getElementsByTagName("span")[0].innerText);else if(M.indexOf("Dateinput")>=0){var P=document.getElementById(c.getElementsByTagName("input")[0].id);b.push(P.value)}else I.stack.push(e),k(I,f),h(I.stack,c,e,f),b.push(I);break;case"img":var Q=document.createElement("canvas");Q.width=2*parseInt(c.style.width),Q.height=2*parseInt(c.style.height);var R=Q.getContext("2d");R.drawImage(c,0,0,Q.width,Q.height);var S=Q.toDataURL("image/png");b.push({image:S,width:d(c.style.width),height:d(c.style.height)});break;case"label":var e=i();h(e.text,c,e,f),b.push({text:e.text.join("")});break;case"select":e=i(),c=document.getElementById(c.id),c.disabled&&(e.style||(e.style=[]),e.style.push("disabled")),e.text=c.value,b.push(e);break;case"textarea":e=i(),c=document.getElementById(c.id),e.text=c.value,b.push(e);break;case"input":var p={text:""},T=c.className,U=A.checked;c=document.getElementById(c.id),T&&T.indexOf("Textinput")>=0||"text"===c.type?p.text=c.value:T&&T.indexOf("Checkbox")>=0||"checkbox"===c.type?p.text=c.checked?U.checkbox.checkedText:U.checkbox.uncheckedText:(T&&T.indexOf("Radio")>=0||"radio"===c.type)&&(p.text=c.checked?U.radio.checkedText:U.radio.uncheckedText),b.push(p.text);break;case"ul":var V={ul:[]};h(V.ul,c,V.ul,f),b.push(V);break;case"ol":var W={ol:[]};c.getAttribute("start")&&(W.start=parseInt(c.getAttribute("start"))),h(W.ol,c,W.ol,f),b.push(W);break;case"li":e=i(),h(b,c,e,f),b.push(e)}return e}function h(a,b,c,d){var e=[],f=b.childNodes;if(b.getAttribute("data-export-style")&&(c.style=b.getAttribute("data-export-style")),0!=f.length)for(var h=0;h<f.length;h++)c=g(e,f[h],c,d);var i=!0,j="";if(0!==e.length)for(var h=0;h<e.length;h++)"string"!=typeof e[h].text&&(i=!1),j+=e[h].text+"",a.push(e[h]);return i&&c&&"object"==typeof c.text&&c.text.length>0&&(a=new Array,a.push(c.text.join(" ")),c.text=c.text.join(" ")),c}function i(){var a={text:[]};return a}function j(){var a={stack:[]};return a}function k(a,b){if(b)for(var c in b)switch(c){case"fontSize":a.fontSize=d(b[c]);break;case"verticalAlign":if(a.rowSpan&&a.rowSpan>1);else switch(b[c]){case"middle":a.verticalAlign="center";break;case"bottom":a.verticalAlign="bottom"}break;case"textAlign":switch(b[c]){case"right":a.alignment="right";break;case"center":a.alignment="center"}break;case"fontWeight":if(isNaN(b[c]))switch(b[c]){case"bold":a.bold=!0}else b[c]>=600&&(a.bold=!0);break;case"textDecoration":switch(b[c]){case"underline":a.decoration="underline"}break;case"fontStyle":switch(b[c]){case"italic":a.italics=!0}break;case"color":b[c]&&(a.color=n(b[c]));break;case"backgroundColor":b[c]&&(a.fillColor=n(b[c]));break;case"borderWidth":var e=b[c].split(" ");"0px"===e[0]&&(a.border=[!1,!1,!1,!1]);break;case"borderLeftWidth":case"borderRightWidth":case"borderTopWidth":case"borderBottomWidth":a.border||(a.border=[!1,!1,!1,!1]);var f={borderLeftWidth:0,borderTopWidth:1,borderRightWidth:2,borderBottomWidth:3},e=b[c].split(" ");"0px"!==e[0]&&(a.border[f[c]]=!0);break;case"marginLeft":case"marginRight":case"marginTop":case"marginBottom":a.margin||(a.margin=[0,0,0,0]);var g={marginLeft:0,marginTop:1,marginRight:2,marginBottom:3};a.margin[g[c]]=d(b[c]);break;case"height":var h=d(b[c]);a.height=h}}function l(a,b){if(b){var c,d,e,f;if(c=d=e=f=!1,void 0!==b.border&&"0px"!==b.border&&(c=d=e=f=!0),"0px"!==b.borderLeftWidth&&(c=!0),"0px"!==b.borderTopWidth&&(d=!0),"0px"!==b.borderRightWidth&&(e=!0),"0px"!==b.borderBottomWidth&&(f=!0),c&&void 0!==a[0].border&&(a[0].border[0]=!0),d)for(var g in a)void 0!==a[g].border&&(a[g].border[1]=!0);if(e){for(var g in a)void 0!==a[g].border&&(a[g].border[1]=!0);void 0!==a[a.length-1].border&&(a[a.length-1].border[2]=!0)}if(f)for(var g in a)void 0!==a[g].border&&(a[g].border[2]=!0)}}function m(a,b){if(b){var c,d,e,f;if(c=d=e=f=!1,void 0!==b.border&&"0px"!==b.border&&(c=d=e=f=!0),"0px"!==b.borderLeftWidth&&(c=!0),"0px"!==b.borderTopWidth&&(d=!0),"0px"!==b.borderRightWidth&&(e=!0),"0px"!==b.borderBottomWidth&&(f=!0),c)for(var g in a)void 0!==a[g][0].border&&(a[g][0].border[0]=!0);if(d)for(var g=0;g<a[0].length;g++)void 0!==a[0][g].border&&(a[0][g].border[1]=!0);if(e)for(var g in a){for(var h=a[g].length-1,i=h;i>0&&("undefined"==typeof a[g][i].border||q(a[g][i]));)i--;if(void 0!==a[g][i].border)if(i!==h&&a[g][i].colSpan){var j=a[g][i].colSpan;h-i==j-1&&(a[g][i].border[2]=!0)}else i!==h&&void 0===a[g][i].colSpan||(a[g][h].border[2]=!0)}if(f)for(var h=a.length-1,g=0;g<a[a.length-1].length;g++){for(var i=h;void 0==a[i][g].border&&i>0&&!(g>=1&&(a[i-1][g].rowSpan||q(a[i-1][g])));)i--;if(void 0!==a[i][g].border)if(i!==h&&a[i][g].rowSpan){var k=a[i][g].rowSpan;h-i==k-1&&(a[i][g].border[3]=!0)}else i!==h&&void 0===a[i][g].rowSpan||(a[i][g].border[3]=!0)}}}function n(a){var b=a.replace(" ","").match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return b?"#"+o(b[1])+o(b[2])+o(b[3]):p(a)}function o(a){var b=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");return isNaN(a)?"00":b[(a-a%16)/16]+b[a%16]}function p(a){var b=a.substring(a.indexOf("(")).split(","),c=parseInt(b[0].substring(1),10),d=parseInt(b[1],10),e=parseInt(b[2],10),f=parseFloat(b[3]);if(c>255||d>255||e>255||f>255)throw"Invalid color component";var g=(256+c).toString(16).substr(1)+((1<<24)+(d<<16)|e<<8|f).toString(16).substr(1);return g=g.substr(0,6),"#"+g}function q(a){for(var b in a)return!1;return!0}function r(b,c,d,e){for(var f=[],g=c.getElementsByClassName("cell"),h=g[g.length-1],i=(parseInt(h.getAttribute("data-alopexgrid-columnindex"))+1,parseInt(h.getAttribute("data-alopexgrid-rowindex"))+1,s(a("#"+c.id))),j=0;j<i[0].length;j++)f.push("*");b.push({table:{body:i,width:f}})}function s(b,c){var d,e,f=b.attr("data-alopexgrid"),g=b.data(AlopexGrid.KEY_NAME),h=a.extend(!0,{},g.state.groupingLookupTableMapById),i=b.alopexGrid("readOption"),j=i.columnMapping,l=g.state.columnIndexToKeyMap,m=u(b),n=a.extend(!0,[],g.state.dataKeyList),o=i.grouping.groupRowspanMode,p=[],q=0,r=g.state.groupHeaderDataMapById,s=g.state.groupFooterDataMapById,v=A.alopexGrid,w=A.styleInfoAttrName,x=A.checked,y=i.columnMapping.slice(g.state.renderFromColumnIndex,g.state.renderToColumnIndex+1),z=g.state.targetDataList.slice(g.state.renderFromRenderedIndex,g.state.renderToRenderedIndex+1),q=(t(b.alopexGrid("dataGet"),z),0),B={},C=[];for(var D in y)y[D].hidden||v.exportDragDropColumn===!1&&y[ha].hasOwnProperty("dragDropColumn")||v.exportSelectorColumn===!1&&y[ha].hasOwnProperty("selectorColumn")||v.exportNumberingColumn===!1&&y[ha].hasOwnProperty("numberingColumn")?(C.push(y[D]),y.splice(D,1),n.splice(D,1)):B[y[D].key]=q++;for(var E=0;E<z.length;E++){var e=z[E],F=(e._index.row,e._state.hasOwnProperty("groupHeader")),G=e._state.hasOwnProperty("groupFooter"),H=e._state.hasOwnProperty("footer");d=new Array(y.length);for(var I in y){var J=y[I],K=d[I]={text:""};if(F||G){var L=(g.state.groupingKeyMap,F?h[e._state.groupHeader].groupKey:h[e._state.groupFooter].groupKey,g._generateCellContent(e,J));if(L){var M=document.createElement("div");M.appendChild(L),K.text=a(M).text()}}else if(H);else{var N,O;if(J.hasOwnProperty("render")){if("function"==typeof J.render)O=J.render,N=O(z[E][J.key],z[E],J.render,J,b[0]),"object"==typeof N?N.nodeType?N=a(N).text():N instanceof jQuery&&N.prop("nodeType")&&(N=N.text()):"string"==typeof N&&/<[a-z][\s\S]*>/i.test(N)&&(tmpDIV.innerHTML=N,N=$tmpDIV.text()),K.text=N;else if(J.render.hasOwnProperty("type")){var P=J.render;switch(P.type){case"radio":var Q="",N=z[E][l[I]];for(var R in P.rule)Q+=P.rule[R].value===N?x.radio.checkedText:x.radio.unchecked,Q+=P.rule[R].text;K.text=Q;break;case"text":default:K.text=""+z[E][l[I]]}}}else J.hasOwnProperty("selectorColumn")?(K.text=z[E]._state.selected?x.checkbox.checkedText:x.checkbox.uncheckedText,K.noWrap=!0):J.hasOwnProperty("dragdropColumn")?(K.text="::",K.noWrap=!0):J.hasOwnProperty("numberingColumn")?K.text=""+E:K.text=""+z[E][l[I]]}if(q=0,ya={},J.hidden!==!0){var S,T=f;if(T+="-"+E+"-"+I,S=document.getElementById(T),S&&S.hasAttribute(w))ya=JSON.parse(S.getAttribute(w)),k(K,ya),K.border=[!0,!0,!0,!0];else{if(a(".bodycell[data-alopexgrid-columnindex="+I+"]").length){var U=a(".bodycell[data-alopexgrid-columnindex="+I+"]").find("["+w+"]");U.length&&U[0].hasAttribute(w)&&(ya=JSON.parse(U[0].getAttribute(w)))}else if(a(".bodycell[data-alopexgrid-rowindex="+E+"]").length){var V=a(".bodycell[data-alopexgrid-rowindex="+E+"]").find("["+w+"]");V.length&&V[0].hasAttribute(w)&&(ya=JSON.parse(V[0].getAttribute(w)))}k(K,ya),K.border=[!0,!0,!0,!0]}q++}}p.push(d)}for(var W in h){var X=h[W],Y=X.member,Z=r[W]?r[W]._index.row:null,$=s[W]?s[W]._index.row:null,_=X.groupDepth;switch(o){case 0:var aa=Y[0]._index.row;if(_===i.grouping.by.length-1)for(var ba=Y[Y.length-1]._index.row,ca=_;ca>=0;ca--){var da=B[i.grouping.by[ca]];a.extend(!0,p[aa][da],{rowSpan:ba-aa+1});for(var ea=aa+1;ba>=ea;ea++)p[ea][da]={}}break;case 1:default:for(var aa=Y[0]._index.row,ba="number"==typeof $?$:Y[Y.length-1]._index.row,fa=$-aa,da=B[i.grouping.by[_]],E=aa+1;ba>E;E++)p[E][da]={};a.extend(!0,p[aa][da],{rowSpan:fa}),_<i.grouping.by.length-1&&(p[$][da].colSpan=i.grouping.by.length-da);break;case 2:for(var aa="number"==typeof Z?Z:Y[0]._index.row,ba=$,da=B[i.grouping.by[_]],E=aa+1;ba>E;E++)p[E][da]={};a.extend(!0,p[aa][da],{rowSpan:ba-aa+1})}}if(i.footer.position){var ga=a(".footercell");d=new Array(y.length);for(var ha=0;ha<y.length;ha++)d[ha]={text:""},ga.eq(ha).attr(w)&&k(d[ha],JSON.parse(ga.eq(ha).attr(w))),d[ha].border=[!0,!0,!0,!0];var ia=a.extend(!0,{},b.alopexGrid("readOption").footer.footerMapping);for(var ja in ia){var ka=g._footerValueByMapping(ia[ja]);d[ia[ja].columnIndex].text=ka}if("top"===i.footer.position){var M=[];M.push(d),p=M.concat(p)}else p.push(d)}for(var la={},ma=0,na=z.length,ja=ma;na>ja;ja++)for(var oa=1;oa<j.length;oa++){var pa=g._getColspanUpto(z[ja],j[oa-1]);if(pa&&pa>=j[oa-1].columnIndex){var qa=y[pa],ra=y[j[oa-1].columnIndex];la[ja]?la[ja].push({colFrom:ra,colTo:qa}):(la[ja]={colFrom:ra,colTo:qa},la[ja]=[la[ja]],oa=qa+1)}}for(var R in la){var sa=la[R][0].colFrom.key,ta=la[R][0].colTo.key,ua=B[sa],va=B[ta];p[R][ua].colSpan=va-ua+1}var M=[];for(var R in m.data){d=new Array(y.length);for(var wa=m.data[R],q=0,E=0;E<i.columnMapping.length;E++){var xa=i.columnMapping[E];if(E>=g.state.renderFromColumnIndex&&E<=g.state.renderToColumnIndex&&xa.hidden!==!0){xa.hasOwnProperty("selectorColumn")&&xa.selectorColumn?(g.state.selectAll?d[q]={text:x.checkbox.checkedText}:d[q]={text:x.checkbox.uncheckedText},d[q].noWrap=!0):d[q]={text:wa[xa.id]};var S,T=f;if(T+="-h-"+R+"-"+E,S=document.getElementById(T),S&&S.hasAttribute(w)){var ya=JSON.parse(S.getAttribute(w));ya.verticalAlign="middle",k(d[q],ya),d[q].border=[!0,!0,!0,!0]}else a(".headercell[data-alopexgrid-columnindex]").eq(0).attr(w)&&(ya=JSON.parse(a(".headercell[data-alopexgrid-columnindex]").eq(0).attr(w)),k(d[q],ya));q++}}M.push(d)}p=M.concat(p);for(var D in m.merges){var za=m.merges[D];if(za.e.r-za.s.r>0){p[za.s.r][za.s.c].rowSpan=za.e.r-za.s.r+1;for(var q=za.s.r+1;q<=za.e.r;q++)p[q][za.s.c]={}}if(za.e.c-za.s.c>0){p[za.s.r][za.s.c].colSpan=za.e.c-za.s.c+1;for(var q=za.s.c+1;q<=za.e.c;q++)i.columnMapping[q].hidden!==!0&&(p[za.s.r][q]={})}}return p}function t(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d];if(e.hasOwnProperty("_index"))for(var f=0;f<b.length;f++){var g=b[f];g.hasOwnProperty("_index")&&e._index.id==g._index.id&&(c[e._index.id]=f)}}return c}function u(b){var c;c="2.3"===b.alopexGrid("readOption").version||"3"===b.alopexGrid("readOption").version?window[window.__AlopexGridExportName__]||AlopexGrid:AlopexGrid;var d=b.alopexGrid("readOption"),e=d.headerGroup,f=d.columnMapping,g=b.data(c.KEY_NAME),h=g.state.columnHeaderDepth;1==d.filteringHeader&&h--;var i=[],j=[],k=[],l=[],m=[];for(var n in f)f[n].hidden&&m.push(f[n]);if(!a.isEmptyObject(e)){i[i.length]={};for(var o=0;o<e.length;o++){1==e[e.length-1].hideSubTitle&&void 0==e[e.length-1].fromIndex&&(e[o].hideSubTitle=!0);var p=v(e[o],f,b,m);if(0!=p.length){for(var q=0,r=0;r<i.length;r++)for(var n=0;n<p.length;n++)if(void 0!=i[r][p[n].id]){q++;break}void 0==i[q]&&(i[q]={});for(var s=0;s<p.length;s++){if(p[s].id){if(i[q][p[s].id]=e[o].title.replace(/<br>/g,"\n"),l[q]||(l[q]=[]),l[q][f.indexOf(p[s])]=[],e[o].headerAlign){var t={align:e[o].headerAlign};l[q][f.indexOf(p[s])]=l[q][f.indexOf(p[s])].concat(t)}d.useCSSParser&&(l[q][f.indexOf(p[s])]=l[q][f.indexOf(p[s])].concat(getHeaderGroupStyle(q))),l[q][f.indexOf(p[s])]=l[q][f.indexOf(p[s])].concat(e[o].headerStyleclass)}1==e[o].hideSubTitle&&(f[f.indexOf(p[s])].hide=!0)}j.push(w(q,e[o],f,b,m))}}}for(var u=[],x=0;x<j.length;x++)if(j[x].rowspan){j[x].e.r=h-1;for(var y=j[x],z=j.length,A=0;z>A;A++)y.s.c<=j[A].s.c&&y.e.c>=j[A].e.c&&x!=A&&u.push(A)}if(u.length>0)for(var o=u.length-1;o>=0;o--)j.splice(u[o],1);i[i.length]={};for(var o=i.length;o>=0;o--)o>=h&&i.splice(o,1);for(var o=0;o<f.length;o++){if(1==f[o].hide)delete f[o].hide;else{"string"==typeof f[o].title?i[i.length-1][f[o].id]=f[o].title.replace(/<br>/g,"\n"):"function"==typeof f[o].title?i[i.length-1][f[o].id]=f[o].title(f[o]):i[i.length-1][f[o].id]="";for(var B=1,s=i.length-2;s>=0;s--)void 0==i[s][f[o].id]&&(i[s][f[o].id]=i[i.length-1][f[o].id],B++);B>1&&j.push({s:{r:i.length-B,c:o},e:{r:i.length-1,c:o}})}d.useGridColumnWidth&&k.push({wpx:parseInt(f[o].width)})}var C={data:i,merges:j,headerGroupStyleMap:l,colWidth:k};return C}function v(a,b,c,d){for(var e=[],f=x(c,[a.fromIndex,a.toIndex],d),g=0;g<b.length;g++)b[g].columnIndex>=f[0]&&b[g].columnIndex<=f[1]&&e.push(b[g]);return e}function w(a,b,c,d,e){var f={s:{r:a,c:-1},e:{r:a,c:-1}};b.hideSubTitle&&(f.rowspan=!0);for(var g=x(d,[b.fromIndex,b.toIndex],e),h=0;h<c.length;h++)c[h].columnIndex==g[0]&&(f.s.c=h),c[h].columnIndex!=g[1]?h===c.length-1&&-1===f.e.c&&(f.e.c=h):f.e.c=h;return f}function x(b,c,d){var e,f=b,g=[];if("2.3"===f.alopexGrid("readOption").version||"3"===f.alopexGrid("readOption").version){var h=window[window.__AlopexGridExportName__]||AlopexGrid;e=f.data(h.KEY_NAME)}else e=f.data(AlopexGrid.KEY_NAME);for(var i=0;i<c.length;i++){var j=c[i];if("number"==typeof j)g.push(parseInt(j));else if("string"==typeof j){var k=a.grep(e.option.columnMapping,function(a){return a.id==j});0==k.length&&(k=a.grep(e.option.columnMapping,function(a){return a.key==j})),g.push(k[0].columnIndex)}}for(var l=!0;1==l;)d.indexOf(g[0])>-1&&g[0]++,d.indexOf(g[1])>-1&&g[1]--,-1==d.indexOf(g[0])&&-1==d.indexOf(g[1])&&(l=!1);return g}void 0===a.fn["export"]&&a.fn.extend({"export":b});var y,z,A,B=function(b,c,d){var f=d;void 0==f&&(f="portrait");var g=a.Deferred();return b&&b.image&&void 0!=b.image?e(b,function(a){-1==a.indexOf("error")?g.resolve(a):g.reject(a)},c,f):g.resolve("none"),g.promise()},C={},D=function(){var b=a.Deferred(),c=a("div.amcharts-main-div");y=c.length;var d;return c.length?c.each(function(a){if(d=this.parentElement,"undefined"==typeof d.id&&(d.id="Alopex_report_c"+parseInt(1e4*Math.random())),AmCharts.charts)for(var c=0;c<AmCharts.charts.length;c++)if(AmCharts.charts[c].div&&AmCharts.charts[c].div.id===d.id){var e=AmCharts.charts[c];C[d.id]=e,e["export"].capture({},function(){this.toPNG({multiplier:2},function(a){this.setup.chart.exportedImage=a,y--,0==y&&b.resolve("pass")})})}}):b.resolve("none"),b.promise()}}(jQuery);